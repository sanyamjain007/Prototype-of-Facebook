<html lang="en">
  <head>
    <title>Facebook Login</title>
   
   <!--  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
   
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

   
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
    <link rel="stylesheet" type="text/css" href="dist/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css"
	href="dist/css/bootstrap-theme.min.css">
<script src="dist/js/jquery-3.1.1.js"></script>
<script src="dist/js/bootstrap.js"></script>
<script src="dist/font/"></script>  

    <link rel="stylesheet" type="text/css" href="fbLogin.css" >

	</head>
 
  <body>
    <div id="wrap">
      <div class="navbar navbar-fixed-top" style=" background-color:#4c66a4">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <p class="navbar-brand" style="color:white;"><b>facebook</b></p>
          </div>
          
		      <div class="collapse navbar-collapse">-
            <form class="navbar-form navbar-right" id="login" role="form" method="post" action="http://localhost:8080/facebook_group6/webapi/users/login">
    				  <div class="lt-left">
    					  <div class="form-group">
    						  <label for="email">Email ID</label><br>
    						  <input name="email" type="email" id="login_email" class="form-control input-sm" placeholder="Email">
    					  </div>
    					  <div class="form-group">
    						  <label for="password">Password</label><br>
    						  <input name="password" type="password" id="pwd" class="form-control input-sm" placeholder="Password">
    					  </div>
    					  <div class="checkbox">
    						  <label>
    						    <input type="checkbox"> Remember me
    						  </label>
    					  </div>
    				  </div>
    				  <div class="lt-right">
    					  <button type="submit" class="login-btn">Login</button>
    				  </div>
    				</form>
          </div>
        </div>
      </div>
      <div class="jumbotron">
      <div class="container" id="home">
		    <div class="row">
        <div class="col-md-7">
          <!-- Buttons Added for project and user info -->
			<input type="button" id="aboutProjectButton" style="margin-top:20px;margin-left:30px;width:120px;"  value="About Project" class="btn btn-primary" data-html="true" data-toggle="modal" data-target="#aboutProjectModal">
            <input type="button" id = "usersListButton" style="margin-top:20px;width:120px" value="Users List" onclick="usersList()" class="btn btn-primary">
            <input type="button" id="consumeButton" value="Expose Service" style="margin-top:20px;width:120px" class="btn btn-primary">
			<!-- Buttons Added for project and user info -->
          <h3 style="margin-top:30px; margin-left:50px;font-family:verdana; color:#0e385f">Facebook helps you connect and share with the people in your life.</h3>
          <img src="fblogin_pic.png" style="margin-left:50px">
           
        </div>
			    <div class="col-md-5">
			     <form class="form" role="form" method="post" id="signup" action="http://localhost:8080/facebook_group6/webapi/register">
			       <h2><b>Create your account</b><h2>
             <div class="row">
                <div class="col-xs-6 col-md-6">
                    <input class="form-control input-lg" name="firstName" id="firstName" placeholder="First Name" type="text" autofocus />
                </div>
                <div class="col-xs-6 col-md-6">
                    <input class="form-control input-lg" name="lastName" id="lastName" placeholder="Last Name" type="text" />
                </div>
             </div>
             <input class="form-control input-lg" name="email" id="signup_email" placeholder="Your Email" type="email" />
             <input class="form-control input-lg" name="password" id="password" placeholder="New Password" type="password" />
             <input class="form-control input-lg" name="contact" id="contact" placeholder="Contact Number" type="text" />
             <input class="form-control input-lg" name="hometown" id="hometown" placeholder="Home Town" type="text" />
             <h4>Birth Date<h4>
                <div class="form-group">
                   <input type="date" class="form-control" id="dob" placeholder="Date of Birth" required="required" name="dob">
               </div>
            <label class="radio-inline">
                <input type="radio" name="gender" id="male" value="M" />Male</label>
            <label class="radio-inline">
                <input type="radio" name="gender" id="female" value="F" />Female</label>
            <br>
            <button class="btn btn-lg btn-primary btn-block signup-btn" type="submit">Create my account</button>
          </form>
			</div>
		</div>
   </div>
  </div>
</div>
</body>
<div id="aboutProjectModal" class="modal fade" role="dialog" style="z-index: 10000000; height:600px; overflow:auto;">
 <div class="modal-dialog">

   <!-- Modal content-->
   <div class="modal-content" style="z-index: 1000000; height:700px; overflow:auto;">
     <div class="modal-header">
       <button type="button" class="close" data-dismiss="modal">&times;</button>
       <h4 class="modal-title">About FacebookPrototype</h4>
     </div>
     <div class="modal-body" id="aboutModalBody" >
       		<p><strong>Title:</strong> Prototype of a Part of Facebook</p>
			<p><strong>Class:</strong> OOAD 2017(Jan-Apr)</p>
			<p><strong>Group Number:</strong> G06</p>
			<p><strong>Group Members:<br></strong>
			<ul>
				<li>MT2016122 - Mr. Sanyam Kumar Jain
					<ul>
						<li>Email Id : Sanyam.Jain2016@iiitb.org
					</ul>
				<li>MT2016116 - Mr. Raju Raghuwanshi
					<ul>
						<li>Email Id : Raju.Raghuwanshi@iiitb.org
					</ul>
				<li>MT2016019 - Mr. Anupam Awasti
					<ul>
						<li>Email Id : Anupam.Awasthi@iiitb.org
					</ul>
				<li>MT2016111 - Mr. Priyank Sharma
					<ul>
						<li>Email Id : Priyank.Sharma@iiitb.org
					</ul>
				<li>MT2016148 - Mr. Vaibhav Paharia
					<ul>
						<li>Email Id : Vaibhav.Paharia@iiitb.org
					</ul>
				<li>MT2016064 - Mr. Akash Jain
					<ul>
						<li>Email Id : Jain.akash@iiitb.org
					</ul>
				<li>MT2016076 -  Ms. Madhurika Jain
					<ul>
						<li>Email Id : Madhurika.Jain@iiitb.org
					</ul>
				<li>MT2016035 - Ms. Bharti Godwani
					<ul>
						<li>Email Id : Bharti.Godwani@iiitb.org
					</ul>
			</ul>
			<p><strong>Instructor:</strong> Dr. K V Dinesha</p>
			<p><strong>College Name:</strong>IIIT BANGALORE</p>
			<p><strong>College Web Address : </strong><a href='http://www.iiitb.ac.in'>www.iiitb.ac.in</a></p>
     </div>
     <div class="modal-footer">
       <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
     </div>
   </div>

 </div>
</div>
<div id="usersListModal" class="modal fade" role="dialog" style="z-index: 10000000; height:600px; overflow:auto;">
 <div class="modal-dialog">

   <!-- Modal content-->
   <div class="modal-content" style="z-index: 1000000; height:700px; overflow:auto;">
     <div class="modal-header">
       <button type="button" class="close" data-dismiss="modal">&times;</button>
       <h4 class="modal-title">List Of Users</h4>
       <div class="row">
       		<div class="col-md-8"><h4>Email ID</h4> </div>
       		<div class="col-md-4"><h4>Password</h4> </div>
       	
       </div>
     </div>
     <div class="modal-body" id="usersListModalBody" >
       
     </div>
     <div class="modal-footer">
       <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
     </div>
   </div>

 </div>
</div>

<script >

$("#consumeButton").click(function(){
	window.location.href="http://localhost:8080/facebook_group6/index.html";
});

function usersList() {
	 $("#usersListModal").modal("show");
	 $("#usersListModalBody").empty();
	 $.ajax({
	 	type : "get",
		url:'http://localhost:8080/facebook_group6/webapi/users/getAllUsers',
	 	success : function(response){
		 	console.log(response);
		 	for(var i=0; i<response.length;i++)
		 	{
		 
		  		var request = response[i];
		  		var div = document.createElement("div");
		  		div.setAttribute("class","row");
		  
		  		var ldiv = document.createElement("div");
		  		ldiv.setAttribute("class","col-md-8");
		  		ldiv.appendChild(document.createTextNode(request['emailId'])) ;
	
		  		var rdiv = document.createElement("div");
		  		rdiv.setAttribute("class","col-md-4");
		  		rdiv.innerHTML = request["password"];
	
		  		div.appendChild(ldiv);
		  
		  		div.appendChild(rdiv);
	
		  
		  		var c = document.createTextNode(response["user_id"]);
		  		console.log(c);
		  		document.getElementById("usersListModalBody").appendChild(div);
	
		 	}
	 	}
	 });
}



$("#signup_email").focusout(function(){
if(document.getElementById("signup_email").value!=''){
$.ajax({
type: "get",
url: "http://localhost:8080/facebook_group6/webapi/users/validate?email="+document.getElementById("signup_email").value,
success: function (response) {
if(response==1)
{
  alert("email already exist");
  document.getElementById("signup_email").value='';
}
console.log(response);
}
});
}
});

var form = $('#login');
form.submit(function () {
 
$.ajax({
type: form.attr('method'),
url: form.attr('action'),
data: form.serialize(),
success: function (data) {
console.log(data);
 
if(data!=null)
{
  sessionStorage.id=data.user_id;
  sessionStorage.fName=data.first_name;
  sessionStorage.lName=data.last_name;
  sessionStorage.dob=data.date_of_birth;
  sessionStorage.homeTown=data.home_town; 
  sessionStorage.contact=data.contact_no;
  sessionStorage.highSchool=data.high_school;
  sessionStorage.currentCity=data.current_city;
  sessionStorage.college=data.college;
  sessionStorage.employer=data.employer;
  sessionStorage.gradSchool=data.graduate_school;
  sessionStorage.profilePicUrl=data.profilePicUrl;
  window.location.href = "http://localhost:8080/facebook_group6/fbHome.html";
}
else
{
  alert("wrong email or password")
}
}
});
return false;
});

var form1 = $('#signup');
form1.submit(function () {
 
$.ajax({
type: form1.attr('method'),
url: form1.attr('action'),
data: form1.serialize(),
success: function (response) {
  console.log(response);
 // alert("d");
  if(response!=null)
  {
	console.log(sessionStorage.fName);
    sessionStorage.id=response.user_id;
    sessionStorage.fName=response.first_name;
    sessionStorage.lName=response.last_name;
    sessionStorage.homeTown=response.home_town;
    sessionStorage.dob=response.date_of_birth; 
    sessionStorage.contact=response.contact_no;
    sessionStorage.highSchool=response.high_school;
    sessionStorage.currentCity=response.current_city;
    sessionStorage.college=response.college;
    sessionStorage.employer=response.employer;
    sessionStorage.gradSchool=response.graduate_school;
    sessionStorage.profilePicUrl=response.profilePicUrl;
    console.log(sessionStorage.lName);
    setTimeout(function(){window.location.href = "http://localhost:8080/facebook_group6/fbHome.html";},3000);
  }
  else
  alert("user already exist!!!");
}
});
return false;
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});

</script>
</html>